DROP TABLE IF EXISTS USERS, ITEMS, BOOKINGS, REQUESTS, COMMENTS CASCADE; 

CREATE TABLE IF NOT EXISTS USERS 
(
                         ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                         NAME VARCHAR,
                         EMAIL VARCHAR(50) NOT NULL,
 			 CONSTRAINT pk_user PRIMARY KEY (ID),
			 CONSTRAINT UQ_USER_EMAIL UNIQUE (EMAIL)
			
);

CREATE TABLE IF NOT EXISTS REQUESTS 
(
                         ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                         DESCRIPTION VARCHAR(250) NOT NULL,
			 REQUESTOR_ID BIGINT REFERENCES USERS (ID) ON DELETE CASCADE,
                         CREATED TIMESTAMP WITHOUT TIME ZONE,                
                         PRIMARY KEY (ID)                       		
);

CREATE TABLE IF NOT EXISTS ITEMS 
(
                         ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                         NAME VARCHAR,                
                         DESCRIPTION VARCHAR(250) NOT NULL,
			 IS_AVAILABLE BOOLEAN,
			 OWNER_ID BIGINT REFERENCES USERS (ID) ON DELETE CASCADE,
			 REQUEST_ID BIGINT REFERENCES REQUESTS (ID) ON DELETE CASCADE,
                         PRIMARY KEY (ID)                       		
);

CREATE TABLE IF NOT EXISTS BOOKINGS 
(
                         ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                         START_DATE TIMESTAMP WITHOUT TIME ZONE,                
                         END_DATE TIMESTAMP WITHOUT TIME ZONE,                
			 ITEM_ID BIGINT REFERENCES ITEMS (ID) ON DELETE CASCADE,
			 BOOKER_ID BIGINT REFERENCES USERS (ID) ON DELETE CASCADE,
                         STATUS VARCHAR(20) NOT NULL,
                         PRIMARY KEY (ID)                       		
);
                                	

CREATE TABLE IF NOT EXISTS COMMENTS 
(
                         ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
                         TEXT VARCHAR(250) NOT NULL,
			 ITEM_ID BIGINT REFERENCES ITEMS (ID) ON DELETE CASCADE,
			 AUTHOR_ID BIGINT REFERENCES USERS (ID) ON DELETE CASCADE,
                         CREATED TIMESTAMP WITHOUT TIME ZONE,                
                         PRIMARY KEY (ID)
);

